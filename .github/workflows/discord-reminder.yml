name: Discord Siege Reminders

on:
  schedule:
    - cron: '50 20 * * *'  # 05:50 JST
    - cron: '50 2 * * *'   # 11:50 JST
    - cron: '50 8 * * *'   # 17:50 JST
    - cron: '50 14 * * *'  # 23:50 JST
  workflow_dispatch:
    inputs:
      message:
        description: '테스트/즉시 실행용 메시지'
        required: false
        default: '@everyone GET READY FOR THE SIEGE IN 5 MINUTES!!!'  # 바꾼 문구 여기에

jobs:
  send_reminder:
    runs-on: ubuntu-latest
    steps:
      - name: Send reminder to Discord
        run: |
          CONTENT="${{ github.event.inputs.message }}"
          if [ -z "$CONTENT" ]; then
            CONTENT='@everyone GET READY FOR THE SIEGE IN 5 MINUTES!!!'
          fi
          echo "Sending: $CONTENT"
          curl -X POST -H "Content-Type: application/json" \
          -d "{\"content\":\"$CONTENT\",\"allowed_mentions\":{\"parse\":[\"everyone\"]}}" \
          "${{ secrets.DISCORD_WEBHOOK_URL }}"

